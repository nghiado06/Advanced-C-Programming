# TÌM HIỂU VỀ JSON
- Khái niệm về Json
- Cách Json hoạt động
- Các hàm thao tác với Json trong C

# 1. KHÁI NIỆM
- JSON là viết tắt của "JavaScript Object Notation" (Ghi chú về Đối tượng JavaScript). Đây là một định dạng truyền tải dữ liệu phổ biến trong lập trình và giao tiếp giữa các máy chủ và trình duyệt web, cũng như giữa các hệ thống khác nhau.
- JSON được thiết kế để dễ đọc và dễ viết cho con người, cũng như dễ dàng để phân tích và tạo ra cho máy tính. Nó sử dụng một cú pháp dựa trên cặp key - value, tương tự như các đối tượng và mảng trong JavaScript. Mỗi đối tượng JSON bao gồm một tập hợp các cặp "key" và "value", trong khi mỗi mảng JSON là một tập hợp các giá trị.

## 2. DỮ LIỆU TRONG JSON
- Dữ liệu trong JSON được tổ chức dưới dạng **Features**, **Object** hoặc **Array**.
- Trong đó:
  - **Feature (thuộc tính)** là một cặp key - value với Key luôn là chuỗi (string), còn value có thể là bất kỳ kiểu dữ liệu JSON hợp lệ nào (string, number, boolean, array, object hoặc null).

```cpp
"Address": "Ho Chi Minh" 
```
Đây chỉ là một cặp key - value, thông thường Json sẽ được tổ chức thành một tổ hợp các cặp key - value này.

  - **Object (đối tượng)** trong JSON là một tập hợp các cặp **key - value** được đặt trong dấu {}. 
```cpp
{
  "name": "Nghia",
  "age": 19,
  "isStudent": true
}
```

Đây là một JSON Object vì nó chứa các cặp key - value.

  - **Array (mảng)** trong JSON là một danh sách các giá trị được đặt trong dấu []. Các giá trị này có thể thuộc bất kỳ kiểu dữ liệu JSON hợp lệ nào.

```cpp
[
  {
    "name": "Nghia",
    "age": 19
  },
  {
    "name": "Dung",
    "age": 25
  }
]
```

Đây là một JSON Array, chứa nhiều JSON Object

## 3. CÁCH TỔ CHỨC JSON
Json sẽ được tổ chức với các khái niệm JsonType, JsonValue, các hàm parse dùng để đọc dữ liệu.

## CẤU TRÚC JSON

## 3.1 JSON Type
- Đây là một biến enum (giả sử JsonType được định nghĩa ở đâu đó) để xác định loại dữ liệu mà JsonValue đang lưu trữ.
- Ví dụ về JsonType:

```cpp
typedef enum
{
    JSON_NULL,
    JSON_BOOLEAN,
    JSON_NUMBER,
    JSON_STRING,
    JSON_ARRAY,
    JSON_OBJECT
} JsonType;
```

## 3.2 Json Value
- JsonValue là một cấu trúc dữ liệu đại diện cho một giá trị JSON tại thời điểm đọc, với khả năng lưu trữ nhiều loại dữ liệu khác nhau (số, chuỗi, boolean, mảng, đối tượng). Khi **parser JSON đọc dữ liệu tuần tự**, mỗi giá trị được phát hiện sẽ được **biểu diễn bằng một JsonValue riêng biệt**, có kiểu dữ liệu tương ứng với nội dung của JSON.
- Cấu trúc của Json Value:

```cpp
typedef struct JsonValue
{
    JsonType type;
    union
    {
        int boolean;
        double number;
        char *string;
        struct
        {
            struct JsonValue *values;
            size_t count;
        } array;
        struct
        {
            char **keys;
            struct JsonValue *values;
            size_t count;
        } object;
    } value;
} JsonValue;
```

Vì bản chất khi đọc dữ liệu thì Json sẽ xử lý từng giá trị một, nên khi khai báo struct JsonValue ta kết hợp dùng **union** để tối bộ nhớ.

## THAO TÁC VỚI JSON
- Các hàm parse dùng để đọc, xử lý các kiểu dữ liệu khác nhau. Mỗi hàm sẽ có một cách xử lý khác nhau.

## 3.3 Cấu trúc dữ liệu đầu vào
- Trước tiên ta cần tìm hiểu về dữ liệu đầu vào để xử lý Json.
- Dữ liệu sẽ bao gồm một chuỗi các kỹ tự, nhiệm vụ của hàm Parse đó chính là xử lý các chuỗi này để đọc và chuyển nó về các kiểu dữ liệu tương ứng.
- Ví dụ như nếu chuỗi là "12" thì nhiệm vụ của hàm parse là đưa giá trị này về kiểu dữ liệu number.


```cpp
const char *json_str = "{"
                           "\"1001\":{"
                           "\"SoPhong\":3,"
                           "\"NguoiThue\":{"
                           "\"Ten\":\"Nguyen Van A\","
                           "\"CCCD\":\"1920517781\","
                           "\"Tuoi\":26,"
                           "\"ThuongTru\":{"
                           "\"Duong\":\"73 Ba Huyen Thanh Quan\","
                           "\"Phuong_Xa\":\"Phuong 6\","
                           "\"Tinh_TP\":\"Ho Chi Minh\""
                           "}"
                           "},"
                           "\"SoNguoiO\":{"
                           "\"1\":\"Nguyen Van A\","
                           "\"2\":\"Nguyen Van B\","
                           "\"3\":\"Nguyen Van C\""
                           "},"
                           "\"TienDien\": [24, 56, 98],"
                           "\"TienNuoc\":30.000"
                           "},"
                           "\"1002\":{"
                           "\"SoPhong\":5,"
                           "\"NguoiThue\":{"
                           "\"Ten\":\"Phan Hoang Trung\","
                           "\"CCCD\":\"012345678912\","
                           "\"Tuoi\":24,"
                           "\"ThuongTru\":{"
                           "\"Duong\":\"53 Le Dai Hanh\","
                           "\"Phuong_Xa\":\"Phuong 11\","
                           "\"Tinh_TP\":\"Ho Chi Minh\""
                           "}"
                           "},"
                           "\"SoNguoiO\":{"
                           "\"1\":\"Phan Van Nhat\","
                           "\"2\":\"Phan Van Nhi\","
                           "\"2\":\"Phan Van Tam\","
                           "\"3\":\"Phan Van Tu\""
                           "},"
                           "\"TienDien\":23.000,"
                           "\"TienNuoc\":40.000"
                           "}"
                           "}";
```












